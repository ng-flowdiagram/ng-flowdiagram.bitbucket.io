<ngx-graph
  class="chart-container"
  [links]="links"
  [nodes]="nodes"
  [curve]="curve"
  [layout]="layout"
  [layoutSettings]="layoutSettings"
  [enableZoom]="true"
  [autoZoom]="true"
  layout="dagreCluster"
>
  <ng-template #defsTemplate>
    <svg:marker id="arrow" viewBox="0 -5 10 10" refX="8" refY="0" markerWidth="4" markerHeight="4" orient="auto">
      <svg:path d="M0,-5L10,0L0,5" class="arrow-head" />
    </svg:marker>
  </ng-template>

  <ng-template #clusterTemplate let-cluster>
    <svg:g class="node cluster">
      <svg:rect
        rx="5"
        ry="5"
        [attr.width]="cluster.dimension.width"
        [attr.height]="cluster.dimension.height"

        [attr.x]="tooltip.x" [attr.y]="tooltip.y"
      />
    </svg:g>
  </ng-template>

  <ng-template #nodeTemplate let-node>
    <svg:g class="node">
      <svg:rect
        [attr.width]="nodeSize(node).width"
        [attr.height]="nodeSize(node).height"
        [attr.fill]="lodash.includes(this.dotarray, node.id) || node.id === 'glseper'? '#cdffe6' : '#fff'"
        stroke-width="2"
        [attr.stroke]="node.stroke"
        stroke-linejoin="round"
        [attr.rx]="node.rx"
      />
      <!-- <path d="M0,0 h200 a20,20 0 0 1 20,20 v200 a20,20 0 0 1 -20,20 h-200 a20,20 0 0 1 -20,-20 v-200 a20,20 0 0 1 20,-20 z" fill="none"   stroke="black" stroke-width="3" *ngIf="node.id === 'glseper'"/> -->
      <circle [attr.cx]="0" [attr.cy]="0" r="20" [attr.stroke-width]="node.strokeWidth" [attr.stroke]="node.stroke" [attr.fill]="node.data.color" *ngIf="lodash.includes(this.dotarray, node.id)" />

      <svg:text [attr.x]="nodeSize(node).width / 2" [attr.y]="node.dimension.height / 2" dominant-baseline="middle" text-anchor="middle" *ngIf="node.id !== 'dot' && node.id !== 'markupcomp'">
        {{node.label}}
      </svg:text>
      <svg:text [attr.x]="nodeSize(node).width / 2" [attr.y]="node.dimension.height / 2" dominant-baseline="middle" text-anchor="middle" *ngIf="node.id === 'dot'">
        &nbsp;
      </svg:text>
      <image [attr.href]="node.img" *ngIf="node.id === 'markupcomp' || node.id === 'dot'" fill="black" height="100" width="100"/>
    </svg:g>
  </ng-template>

  <ng-template #linkTemplate let-link>
    <svg:g class="edge">
      <svg:path class="line" stroke-width="2" marker-end="url(#arrow)"></svg:path>
      <svg:text class="edge-label" text-anchor="middle">
        <textPath
          class="text-path"
          [attr.href]="'#' + link.id"
          [style.dominant-baseline]="link.dominantBaseline"
          startOffset="50%"
        >
          {{link.label}}
        </textPath>
      </svg:text>
    </svg:g>
  </ng-template>
</ngx-graph>

<!-- Right side panel -->
<div class="right-panel">
  <h4>Current Recomendation</h4>
  <div style="margin: 28px 0;">
    <h5>Margin increased oppurtunity: $334.45</h5>
    <h6 class="text-muted">Recomendation generated at 05-08-21</h6>
  </div>

  <ul class="list-group list">
    <li class="list-group-item" *ngFor="let item of dotarray" style="margin-bottom: 15px; display: flex;" (mouseenter)="mouseEnter(item)"  (mouseleave)="mouseLeave(item)">
      <i class="fa fa-circle" aria-hidden="true" [style.color]="setDot(item)"></i>
      <div>
        <h6> {{setname(item)}} </h6>
        <span class="text-muted" style="font-size: small ;"> {{setDes(item)}} </span>
      </div>
    </li>
  </ul>
</div>

<!-- Toolip -->
<!-- <div class="alert alert-success" [style.top.px]="tooltip.x"  [style.left.px]="tooltip.y" style="position:fixed; z-index:5;" role="alert">fwefwe {{tooltip | json}}</div> -->
